<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Generator</title>
    <style>
        body { margin: 20px; font-family: Arial, sans-serif; }
        .input-group { margin-bottom: 10px; }
        label { display: block; margin: 5px 0; }
        input, textarea, select { width: 100%; max-width: 600px; padding: 5px; box-sizing: border-box; }
        button { padding: 8px 16px; margin-top: 10px; cursor: pointer; }
        #output { max-width: 600px; border: 1px solid #ccc; padding: 10px; min-height: 200px; }
        #status { color: #666; margin-top: 10px; }
    </style>
</head>
<body>
    <h2>Document Generator</h2>
    <div class="input-group">
        <label for="title">Title:</label>
        <input type="text" id="title" placeholder="Enter title">
    </div>
    <div class="input-group">
        <label for="body">Body:</label>
        <textarea id="body" rows="4" placeholder="Enter body text"></textarea>
    </div>
    <div class="input-group">
        <label for="tableData">Table (e.g., Item1,Value1,Item2,Value2):</label>
        <input type="text" id="tableData" placeholder="Comma-separated pairs">
    </div>
    <div class="input-group">
        <label for="style">Style:</label>
        <select id="style">
            <option value="arial">Arial</option>
            <option value="times">Times New Roman</option>
            <option value="mono">Monospace</option>
        </select>
    </div>
    <button id="generateBtn">Generate File</button>
    <div id="output"></div>
    <div id="status"></div>

    <script>
        function getInputs() {
            return {
                title: document.getElementById('title').value.trim() || 'Untitled',
                body: document.getElementById('body').value.trim() || 'No content yet',
                tableData: document.getElementById('tableData').value.trim() || '',
                style: document.getElementById('style').value
            };
        }

        function buildContent({ title, body, tableData }) {
            let html = `<h1>${escapeHTML(title)}</h1>`;
            html += `<p>${escapeHTML(body).replace(/\n/g, '<br>')}</p>`;
            if (tableData) {
                const items = tableData.split(',').map(item => item.trim());
                if (items.length % 2 !== 0) items.push('N/A');
                html += `<table border="1"><tr><th>Item</th><th>Value</th></tr>`;
                for (let i = 0; i < items.length; i += 2) {
                    html += `<tr><td>${escapeHTML(items[i])}</td><td>${escapeHTML(items[i + 1])}</td></tr>`;
                }
                html += `</table>`;
            }
            return html;
        }

        function escapeHTML(str) {
            return str.replace(/&/g, '&').replace(/</g, '<').replace(/>/g, '>').replace(/"/g, '"').replace(/'/g, '');
        }

        function downloadFile(content, style) {
            const fontFamily = style === 'times' ? 'Times New Roman, serif' : 
                             style === 'mono' ? 'Courier New, monospace' : 
                             'Arial, sans-serif';
            const fullHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { font-family: ${fontFamily}; margin: 20px; }
                        table { border-collapse: collapse; }
                        th, td { border: 1px solid black; padding: 5px; }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `;
            const blob = new Blob([fullHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'document.html';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function updatePreview(content) {
            document.getElementById('output').innerHTML = content;
        }

        function showStatus(message) {
            const status = document.getElementById('status');
            status.textContent = message;
            setTimeout(() => status.textContent = '', 3000);
        }

        document.getElementById('generateBtn').addEventListener('click', () => {
            const inputs = getInputs();
            const content = buildContent(inputs);
            updatePreview(content);
            downloadFile(content, inputs.style);
            showStatus('File generated!');
            document.getElementById('title').value = '';
            document.getElementById('body').value = '';
            document.getElementById('tableData').value = '';
            document.getElementById('output').innerHTML = '';
        });
    </script>
</body>
</html>
